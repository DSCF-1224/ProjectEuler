# file created : 2018.10.30
# file updated : 2018.10.30
# 
# Version 1.0.1 (2018-09-29)
# Base.MainInclude.include( "ProjectEuler/Problem0002/0002_05.jl" )
# 

# Project Euler
# https://projecteuler.net/problem=2
# Problem 0002 [Even Fibonacci numbers]
# Each new term in the Fibonacci sequence is generated by adding the previous two terms.
# By starting with 1 and 2, the first 10 terms will be:
#	1, 2, 3, 5, 8, 13, 21, 34, 55, 89, ...
# By considering the terms in the Fibonacci sequence whose values do not exceed four million,
# find the sum of the even-valued terms.

# references
# https://qiita.com/yopya/items/50876cf06e04538ffde8#problem-2-%E5%81%B6%E6%95%B0%E3%81%AE%E3%83%95%E3%82%A3%E3%83%9C%E3%83%8A%E3%83%83%E3%83%81%E6%95%B0

function problem0002( upperlimit::Core.Integer )

	# STEP.01
	# set the initial conditions of Fibonacci sequence
	fibonacci1 = Base.one( upperlimit )
	fibonacci2 = Base.one( upperlimit ) + fibonacci1

	# STEP.02
	# check the inputted `upperlimit`
	if upperlimit <= fibonacci1

		# STEP.02.01
		# if the `upperlimit` was less than or equal to `1` -> it is not valid
		return Base.error( "Inputted upper limit is not valid. It is too small. Please input an integer which is greater than one." )

	elseif Base.isequal( upperlimit , fibonacci2 )

		# STEP.02.02
		# if the `upperlimit` was equal to `1` -> it is not valid
		sum = fibonacci2

	else

		# STEP.02.03
		# if the `upperlimit` was greater than `2` -> calculate until the `upperlimit`

		# STEP.02.03.01
		# initialize the buffer of the sum
		sum = Base.zero( upperlimit )

		# STEP.02.03.02
		# calculate the target sum
		while Base.isless( fibonacci2 , upperlimit )

			# STEP.02.03.03
			# update the sum
			if Base.iseven( fibonacci2 )
				sum = Base.Checked.checked_add( sum, fibonacci2 )
			end

			# STEP.02.03.04
			# update the Fibonacci sequence
			fibonacci2 = Base.Checked.checked_add( fibonacci1, fibonacci2 )
			fibonacci1 = Base.Checked.checked_sub( fibonacci2, fibonacci1 )

		end
	end

	# STEP.END
	return sum
end

upperlimit_target = 4*10^6
Base.@timev Base.Printf.@printf( Base.stdout , "%d\n" , problem0002( upperlimit_target ) )
Base.println( stdout , " " )

upperlimit_target = 4*10^7
            Base.Printf.@printf( Base.stdout , "%d\n", upperlimit_target )
Base.@timev Base.Printf.@printf( Base.stdout , "%d\n", problem0002( upperlimit_target ) )
Base.println( stdout , " " )

upperlimit_target = 4*10^8
            Base.Printf.@printf( Base.stdout , "%d\n", upperlimit_target )
Base.@timev Base.Printf.@printf( Base.stdout , "%d\n", problem0002( upperlimit_target ) )
Base.println( stdout , " " )

upperlimit_target = 4*10^9
            Base.Printf.@printf( Base.stdout , "%d\n", upperlimit_target )
Base.@timev Base.Printf.@printf( Base.stdout , "%d\n", problem0002( upperlimit_target ) )
Base.println( stdout , " " )

upperlimit_target = 4*10^10
            Base.Printf.@printf( Base.stdout , "%d\n", upperlimit_target )
Base.@timev Base.Printf.@printf( Base.stdout , "%d\n", problem0002( upperlimit_target ) )
Base.println( stdout , " " )

upperlimit_target = 4*Base.GMP.BigInt( 10 )^10000
            Base.Printf.@printf( Base.stdout , "%d\n", upperlimit_target )
Base.@timev Base.Printf.@printf( Base.stdout , "%d\n", problem0002( upperlimit_target ) )


# 40000000
# 19544084
# 0.000140 seconds (30 allocations: 784 bytes)
# elapsed time (ns): 139946
# bytes allocated:   784
# pool allocs:       30

# 400000000
# 350704366
# 0.000486 seconds (30 allocations: 784 bytes)
# elapsed time (ns): 485973
# bytes allocated:   784
# pool allocs:       30

# 4000000000
# 1485607536
# 0.000194 seconds (30 allocations: 784 bytes)
# elapsed time (ns): 194133
# bytes allocated:   784
# pool allocs:       30

# 40000000000
# 26658145586
# 0.000158 seconds (30 allocations: 784 bytes)
# elapsed time (ns): 157867
# bytes allocated:   784
# pool allocs:       30

# 400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
# 00000000000000000000000000000000000000000
# 283797891757327777213843140513035692815812644071043629300650846525541226204766928141194170058024973841747739712931590495
# 559076875384458204054769820528084013780571839823429869192791515687149058031793443211613641826950932682995227103572941337
# 638450457918062315977033905974237308332789794663571491838049113036439285990545540274796625636539030498214018569919651026
# 605268705648988538272634686767835394144903633269626392329748746408887116705387950520398397350768692606259280556908233652
# 808297002323693694599625541638173264541774909646405702648781019217879753712512074565684809593189943965145891740675364738
# 833341119035761926341644978769381274272019195066725384100633011521895724121600473789738618584626850308167596770021753783
# 572880857674120424914803608457818315183944095213558179053437398156640415448923390176609553398994817692867490235341537765
# 529046831988467585966741688193256485169574858872641700940723596585111327163935792545625448006711461280628858334536098248
# 082498430879997071832695039518861313521226159990458896310915440331632698087803453341249261724135840860527528824002076963
# 348306267681860677219929495563365028313832481069207191179155679046574470822894507998653680604769701370114298768633777527
# 086119202312627322047533235896533665545188138924647440641663279419306784367815525593501434059133212003412770927861703835
# 803000130650207598462045808683871411319737241430657709560719448708437078183550195418878822038422922980823695195978895483
# 262970792611650133681604519372801059165403693437361405887649720463991845712884663109716804684221364327858238570901107372
# 284786393846383631152509629984196991169055065779602592595301779729652517733227853693179306147241911730052727449344517237
# 174240029901202954906026226833838797879972216589192506907741170444898679699899448598339935715184692594094845222154203942
# 818819638562951452562860646182937532651437447132624735381747078292575237774601581331096042001272654332348684543811948335
# 699645001260497036647621052680127177368844131417744684290199488217441622243132867068781996038758364464661449842700443967
# 914930066658826073419900878003009253511954529481572816173927022520011154051370050785071546982025737887556009993648386542
# 305805533304582922853369873621997754117476049848170654724085604336580907976069221347448390839315980855831277827950988179
# 621548902327113550097357528772072562112065087915374845554057929837508929105107539021450691774635062091894267018885428393
# 366511483221788041904584182797722553946642516679422492915577925927804237083831413939293784274353507071393446930100374888
# 450989861029185333970636275602721742600014551913066432647363205058442377653679530064967314578333481010090455519664113852
# 534845121530896562115031708565887987309319570294676779773084491706088647865263316869554760296287768419751300889289519696
# 461456231354840162773259433084423531404491700681021275529196904816489253099628795399013446064878362066462043297829896857
# 150744211116148525697692492232865405500056775945583155437947897020078612872879467333306743013628253849962875707843148730
# 676379412383331274887187730610150245534359296272193418703476193097242490812868969194097667865845390988238436579429365689
# 607797341948529404166199384940682106472202828117735940195807473827931930726773007035814472941549456763085758198002960628
# 952535812473983283530202944949192645468416918281372166798765671838605505556516600374662050215690285235927777786975685290
# 611117021436370666032233281237771347876153469207770704294574218279229697671196485114458227266879225221330383766987335698
# 649624699747462077261845577300147131282119788135425636899952369902028589812749793766515808473604299709100020111058855909
# 407707239469016123645525593923120689019826001868883361916172826281597732279941298706150843707100605117604212390897616099
# 822761663975959192953888888956181208142977814765700573673345667956276647167439709624395213973285557540790723349907917842
# 758310512334417027004339799987333173447406560366176038915192657354913958903322703298768221431415683332796529882625861805
# 299000829135124463254222191789563753975287062385152775219645217564400968741689014386511540605841901186432682938397698940
# 447364052906128776265508473994238548999304126457649691407476458262047285971208589561739595237852682743075999832006715826
# 929509992199039137672676270289977305506093970986245154062932718665694399918338349851667238982446215495447352367381971384
# 304689182875723551548354785477335643967821203919949817352337197012572982674623147152241777608779636488872262807623746240
# 357770889244697003569369976403390951243516305397343508354298333916984586650857133953004895074711255142280923245176941434
# 752304829648644054080536783866229893096676460825928261280262250782530007192116759795548013792061873408170924541499259000
# 100906790461907548780247051706365647716554081519308948960698649772996630932437229278046962892569636778766445343140949202
# 798197592990539371124561533326506220949902251859142470127893017068936337839436294010289444424956412546826357711879967789
# 966490944184479276364747934440005152013987993230155079756409722614406448045736110485776976143713951557624456873721168129
# 915317947498626311815105567886405023382552773988364819730600256197257491898361868055388607777418085964197345522872611223
# 407639488919116607098688451202978569954442706791562305471706838366929730316839489449875622606459919166160212617826186652
# 386311091990107009968387450655167134892233197483621176867818883398511779242418881358860835135139539224245082353958876994
# 436371836703461611223998613229565898669574028757189039595320831833864902324080314223169970204960938393491687475532969021
# 329545487379646411322543260419163829645592750664175324813679961588606254266992540026623895598239544406136670986474699418
# 718704967139354614966671416215631971180665519323626362924159168722450557236496120050847804740578705173824349337549423219
# 394980966745830391682719752098821639924267110890350616762472809964522523558447113565269054046256413926575860373036783224
# 779375232384712158953242133363007077771669397033628914020988877833157095153835852677756320630185584908076227151324446448
# 384438976409474900727936164341922457676251619857064567514314330597568458534384316700523019613790676400739072534697243681
# 598824587573507740714055538286260973529791046611756715134660406293558587755136643714730071777476690940168856536517858348
# 479559604283389894120522906033513305442654268460916193360140314790310014448435792176102691263331116021617962385034629531
# 429378415329156599608616312497765273587301917981756710168368164338958850933556981270192514856126301294966534330896694293
# 633508014071447464933452659465383625419196834784300129678214737495161481201301923355539915315843032238537390050105816929
# 100329444990037944592853992078157201322732274904758328175013793548396758194373584976014110900916358774451930733134678683
# 815377116572981985328589302955562587939372020123646034963408947778509892557199678292727705307720264601876360324061173485
# 208021448849986972254635063507060846409743334174183958222419082600002071048892056239289498590309810664355206326521925452
# 643973997157654707003757456040474732565306144583556523793538171801247900115517484640749756273319582465662467784708822776
# 305731272898841953586649193645992745609427107671772221353058661746791651198189513848690506473026269560597968631209014390
# 280823200104405987284994653228638204873515957761900374218943448290521321719772207104057315624354391437928617001989061519
# 667524001625670553351606405197998880917705077735555899892594969671867881470523854070519767843738455095768883634778291676
# 922642346095852239873721813499570110672921190503491470975487201441903186681737821385597362916274012968245965791031834279
# 765960654224415980547343521599403570201651683549776578688192032633036456572394168769801906800577169410449244694151049782
# 024429549855360600828061379430170040614596880984402933267883670465828488895725597119767730735984803977028330372942594304
# 416660559491714501625139300068389995283430303990439290862482921304103692880979172264243203418921019326373051422269304244
# 455490091618164324630730378818448933634716895072842081212048823845296208429846447649214944574738085139715503102120519227
# 307604800532012121651243788866386698962507569920067469563767966475719923117289033181603162862442903200179249026399265143
# 170179257835736160941757936563812787512829058121570281274442344409363170661928534362547095470647770551806915726783107488
# 163158111792430736279520413798192922222890383783919772212824504165063863380889114874350337769165460764294797979036055737
# 220157788666043825542124778773092442792961629108860736842070914483408852057212648320126603684110195592626742284727284622
# 931977332004112589191596829097349873603827585273061637512335179029775501123361467756401131386116397109366922600244273487
# 501999028494209156494845211554094583339606127524765946236094413455708788785362404520694179442002849583066887917738786873
# 496963405361801305985545932826162213073194356913135747255991094658989045454059487046734519591928380478299191242804602845
# 154232876904563517627991179771146556258040108062753490573973635199011068568606889407945023749462529812985982790330788205
# 824041656437187059558192370117196757739489140810774919861986786173874557538460541322061138805893686792949215823766592450
# 158531060430559822247876890944345690062369015028791464631889604266947148523018353557207659803903130136593160261845416092
# 621448871997966728387810218113544153422410790863151368496930023914836199321482742308383257651484488605412159081142319156
# 434947634718285243523354997947803612450314360487527380146798358115170166121278010484577029919215188933699020380700438751
# 202128420561902608530071684836030617114045820870342202886985072371243711482112844000577631761588168535785695397201716578
# 777143156675683867397731281076349851694364577012091368693013108741643757564586409930774788453401854280353227922446003572
# 117020811443869364055337594539760822126994402294023846093468094451956483969231352074679744022745466300483656057356533587
# 347156534815180795899301097884231962743551864963442868477200291506802518349177762164108925880279559881095366291704210757
# 68891297348904236882144553649343454401072
# 0.288895 seconds (753.74 k allocations: 238.391 MiB, 7.20% gc time)
# elapsed time (ns): 288894653
# gc time (ns):      20793991
# bytes allocated:   249971307
# pool allocs:       386863
# non-pool GC allocs:2
# malloc() calls:    255217
# realloc() calls:   111656
# free() calls:      247858
# GC pauses:         10